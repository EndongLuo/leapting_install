"use strict";(self["webpackChunkleapting_install"]=self["webpackChunkleapting_install"]||[]).push([[2],{5519:function(e,t,s){s.d(t,{Z:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"L_table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.filterData,stripe:!0,"default-expand-all":""}},[e._l(e.column,(function(s){return t("div",{key:s.id},[t("el-table-column",{attrs:{prop:s.prop,label:s.label,width:s.width}},["status"==s.prop?t("div",[t("el-switch",{attrs:{prop:s.prop,"active-color":"#13ce66","inactive-color":"#ff4949"}})],1):e._e()])],1)})),t("el-table-column",{attrs:{fixed:"right",label:"Operate",width:"150"},scopedSlots:e._u([{key:"default",fn:function(s){return["behaviorInfo"==e.tableName?t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSend(s.row)}}},[t("span",[e._v(e._s(e.$t("table.send")))])]):t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleClick(s.row)}}},[e._v(" "+e._s(e.$t("table.edit"))+" ")]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleStop()}}},[t("span",[e._v(e._s(e.$t("table.stop")))])])]}}])})],2),t("el-pagination",{attrs:{background:"","current-page":e.currentPage,"pager-count":e.pageCount,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],n=s(408),o={props:["tableData","column","tableName"],data(){return{currentPage:1,pageSize:10,pageCount:5}},computed:{total(){return this.tableData.length},filterData(){let e=(this.currentPage-1)*this.pageSize,t=this.currentPage*this.pageSize;return this.tableData.slice(e,t)},...(0,n.rn)("ros",["ros"])},methods:{handleClick(e){console.log(e)},handleSend(e){console.log({behavior_name:e.behavior_name}),this.$emit("sendGoal",{behavior_name:e.behavior_name})},handleStop(){this.$emit("isCancel","aaa")},handleDelete(e,t,s){this.$confirm(`此操作将永久删除该文件: ${e.behavior_name}`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning"}).then((()=>{var a=new ROSLIB.Topic({ros:this.ros,name:"/trig",messageType:"std_msgs/Header"});a.publish({frame_id:`flexbe_delete:${e.behavior_name}`}),s.splice(t,1),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e}}},l=o,r=s(1001),h=(0,r.Z)(l,a,i,!1,null,"51ed4ebe",null),c=h.exports},1002:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var a=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"send_cancel"},[t("el-input",{attrs:{placeholder:"Task Name",clearable:""},model:{value:e.goalMsg.behavior_name,callback:function(t){e.$set(e.goalMsg,"behavior_name",t)},expression:"goalMsg.behavior_name"}}),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sendGoal(e.goalMsg)}}},[e._v(e._s(e.$t("table.send")))]),t("el-button",{attrs:{type:"danger"},on:{click:e.isCancel}},[e._v(e._s(e.$t("table.stop")))])],1),t("L_table",{attrs:{tableData:e.filterData,column:e.column,tableName:"behaviorInfo"},on:{sendGoal:e.sendGoal,isCancel:e.isCancel}})],1)},i=[],n=(s(7658),s(5519)),o=s(408);s(5102);const l={data(){return{goon:0,isShow:0,isInstall:0,isVideo:0,isThree:0,flexbeSwitch:!0,pvm_num:50,goal:null}},computed:{...(0,o.rn)("ros",["ros"])},created(){},mounted(){this.start},methods:{start(e){if(this.goon)this.Pause();else if(this.flexbeSwitch=!1,this.isInstall=e,this.isInstall)this.$message(this.$t("prompt.switchMode"));else if(1==e){this.isShow=e,this.isInstall=e;var t=1!=e;this.$message.success("Start Installation."),this.sendGoal(t,50)}else this.$prompt(this.$t("prompt.inputNum"),this.$t("prompt.prompt"),{confirmButtonText:this.$t("mains.confirm"),cancelButtonText:this.$t("mains.cancel"),inputPattern:/[1-9]{1}\d{0,3}/,inputErrorMessage:this.$t("prompt.inputErrorMessage")}).then((({value:t})=>{this.isShow=e,this.isInstall=e;var s=1!=e;this.$message.success("success: "+t),console.log(Number(t)),this.sendGoal(s,t)})).catch((()=>{this.isInstall=0,this.flexbeSwitch=!0,this.isShow=0,this.$message(this.$t("mains.cancel"))}))},sendGoal(e,t){var s=localStorage.getItem("pvm_param");const{pvm:a}=JSON.parse(s);var i=new ROSLIB.Message({behavior_name:"CommInstallPVM",arg_keys:["auto","pvm_num","pvm_width","install_gap"],arg_values:[`${e}`,`${t}`,a.pvm_width,a.install_gap]}),n=new ROSLIB.ActionClient({ros:this.ros,actionName:"flexbe_msgs/BehaviorExecutionAction",serverName:"/flexbe/execute_behavior"});this.goal=new ROSLIB.Goal({actionClient:n,goalMessage:i}),this.goal.on("feedback",(e=>{this.$message(`feedback: ${JSON.stringify(e)}`),console.log("Feedback: ",e)})),this.goal.on("result",(e=>{this.$message(`result: ${JSON.stringify(e)}`),console.log("Final Result: ",e)}))},Pause(){this.goon=1;var e=new ROSLIB.Topic({ros:this.ros,name:"/flexbe/command/pause",messageType:"std_msgs/Bool"});this.flexbeSwitch?(this.$message.success("Go on."),this.flexbeSwitch=!1):(this.$message("Pause"),this.flexbeSwitch=!0),console.log(this.flexbeSwitch),e.publish({data:this.flexbeSwitch})}},Stop(){var e=new ROSLIB.Topic({ros:this.ros,name:"/flexbe/command/preempt",messageType:"std_msgs/Empty"});e.publish({}),this.$message.success("Installation Stopped."),this.isInstall=0,this.flexbeSwitch=!0,this.isVideo=0,this.isThree=0,this.isShow=0,this.goon=0}};var r={components:{L_table:n.Z},data(){return{tableData:[],column:[{id:"004",prop:"behavior_tag",label:"Tag",width:150},{id:"001",prop:"uid",label:"Sr.No.",width:100},{id:"002",prop:"behavior_name",label:"Task",width:200},{id:"003",prop:"behavior_msg",label:"Description"}],goalMsg:{behavior_name:""},goal:null}},mixins:[l],computed:{...(0,o.rn)("ros",["ros","flexbeParams"]),filterData(){return this.tableData.filter((e=>-1!==e.behavior_name.indexOf(this.goalMsg.behavior_name)))}},mounted(){this.behaviorList()},methods:{filterParam(e){try{var t=this.flexbeParams[e];return t?{arg_keys:Object.keys(t),arg_values:Object.values(t)}:{arg_keys:[],arg_values:[]}}catch(s){return{arg_keys:[],arg_values:[]}}},behaviorList(){var e=new ROSLIB.Topic({ros:this.ros,name:"flexbe/behavior_list",messageType:"std_msgs/String"});e.subscribe((e=>{this.tableData=[];var t=JSON.parse(e.data),s=1;for(let a in t)"hide"!==t[a].tag&&this.tableData.push({uid:s++,behavior_name:a,behavior_msg:t[a].description,behavior_tag:t[a].tag})}))},sendGoal(e){if(console.log(e),"CommUninstallPVM"==e.behavior_name||"CommInUninstall"==e.behavior_name)this.$prompt(this.$t("prompt.uninputNum"),this.$t("prompt.prompt"),{confirmButtonText:this.$t("mains.confirm"),cancelButtonText:this.$t("mains.cancel"),inputPattern:/[1-9]{1}\d{0,3}/,inputErrorMessage:this.$t("prompt.inputErrorMessage")}).then((({value:t})=>{this.$message.success("success: "+t),console.log(Number(t)),this.CommInstall(Number(t),e)})).catch((()=>{this.$message(this.$t("mains.cancel"))}));else{console.log("goalMsg",e);var{arg_keys:t,arg_values:s}=this.filterParam(e.behavior_name),a=new ROSLIB.Message({behavior_name:e.behavior_name,arg_keys:t,arg_values:s});this.actionClient(a)}},CommInstall(e,t){var{arg_keys:s,arg_values:a}=this.filterParam(t.behavior_name),i=new ROSLIB.Message({behavior_name:t.behavior_name,arg_keys:["pvm_sum",...s],arg_values:[`${e}`,...a]});console.log(i),this.actionClient(i)},actionClient(e){var t=new ROSLIB.ActionClient({ros:this.ros,actionName:"flexbe_msgs/BehaviorExecutionAction",serverName:"/flexbe/execute_behavior"});this.goal=new ROSLIB.Goal({actionClient:t,goalMessage:e}),console.log(this.goal),this.goal.send(),this.goal.on("feedback",(e=>{console.log("Feedback: ",e)})),this.goal.on("result",(e=>{"preempted"==e.outcome&&this.$message("task over！"),console.log("Final Result: ",e)}))},Pause(){this.goon=1;var e=new ROSLIB.Topic({ros:this.ros,name:"/flexbe/command/pause",messageType:"std_msgs/Bool"});this.flexbeSwitch?(this.$message.success("Go on."),this.flexbeSwitch=!1):(this.$message("Pause"),this.flexbeSwitch=!0),console.log(this.flexbeSwitch),e.publish({data:this.flexbeSwitch})},isCancel(e){console.log(e),this.goal&&(this.$message("行为取消！"),this.goal.cancel())}}},h=r,c=s(1001),m=(0,c.Z)(h,a,i,!1,null,"60df478b",null),g=m.exports}}]);
//# sourceMappingURL=2.3aa8bb45.js.map